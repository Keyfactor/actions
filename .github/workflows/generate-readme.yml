name: Generate README from templates and data files
on:
  workflow_call:
    secrets:
      token: 
        description: 'Secret token from caller workflow to approve readme'
        required: true
permissions:
  contents: write

jobs:
  update-docs:
    runs-on: ubuntu-latest
    steps:
      - name: Debug Token
        run: |
            echo "Token: ${{ secrets.GITHUB_TOKEN }}"
            echo "V2Token: ${{ secrets.V2BUILDTOKEN }}"
        shell: bash

      - name: Download repo
        uses: keyfactor/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Download doctool
        uses: keyfactor/checkout@v4
        with:
          repository: 'Keyfactor/actions'
          path: './actions/'
          token: ${{ secrets.GITHUB_TOKEN }}
          ref: 'v3' # Update this tag for testing new readme templates branches

      # - name: Run doctool action
      #   uses: ../doctool/
      #   with:
      #     token: ${{ secrets.GITHUB_TOKEN }}

      # - uses: Keyfactor/doctool@main
      #   with:
      #     token: ${{ secrets.GITHUB_TOKEN }}

